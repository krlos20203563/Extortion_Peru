setwd("~/Tesis_de_Licenciatura/Extortion_Peru")
knitr::opts_chunk$set(echo = TRUE)
library(AER)
library(ggplot2)
library(magrittr)
library(MASS)
library(stargazer)
library(kableExtra)
library(rio)
library(knitr)
library(modelsummary)
tesis=import("https://github.com/krlos20203563/Extortion_Peru/raw/refs/heads/main/datafinal.csv")
View(tesis)
reg_pol=glm.nb(denuncias~num_comisarias+personal+n_patru+area_com+old_com+com_internet, data = tesis, family(poisson(link = "log")))
reg_pol=glm.nb(denuncias~num_comisarias+personal+n_patru+area_com+old_com+com_internet, data = tesis, family = poisson(link = "log"))
reg_pol=glm.nb(denuncias ~ num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = poisson(link = "log"))
summary(reg_pol)
reg_pol=glm.nb(denuncias ~ num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = poisson(link = "log"))
reg_pol=glm(denuncias ~ num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = poisson(link = "log"))
summary(reg_pol)
overdispersion=AER::dispersiontest(reg_pol,alternative='greater')$ p.value<0.05
underdispersion=AER::dispersiontest(reg_pol,alternative='less')$ p.value<0.05
# tabla
testResult=as.data.frame(rbind(overdispersion,underdispersion))
names(testResult)='Es probable?'
testResult%>%kable(caption = "Test de Equidispersión")%>%kableExtra::kable_styling()
stargazer(reg_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_bn.txt")
stargazer(reg_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_bn.txt")
overdispersion <- AER::dispersiontest(reg_pol, alternative = 'greater')$p.value < 0.05
underdispersion <- AER::dispersiontest(reg_pol, alternative = 'less')$p.value < 0.05
# Crear tabla con los resultados
testResult <- data.frame(
Tipo = c("Sobredispersión", "Subdispersión"),
Resultado = c(overdispersion, underdispersion)
)
# Imprimir tabla como texto simple, adecuado para Word
print(testResult)
overdispersion <- AER::dispersiontest(reg_pol, alternative = 'greater')$p.value < 0.05
underdispersion <- AER::dispersiontest(reg_pol, alternative = 'less')$p.value < 0.05
# Crear tabla con los resultados
testResult <- data.frame(
Tipo = c("Sobredispersión", "Subdispersión"),
Resultado = c(overdispersion, underdispersion)
)
# Imprimir tabla como texto simple, adecuado para Word
print(testResult)
reg_pol=glm(denuncias ~ num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = poisson(link = "log"))
reg_bnpol=glm.nb(denuncias~num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis)
stargazer(reg_bnpol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_bn.txt")
summary(reg_bnpol)
rq_pol=glm(denuncias~num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = quasipoisson(link = "log"))
stargazer(rq_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_bn.txt")
summary(rq_pol)
stargazer(reg_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_poisson.txt")
stargazer(reg_bnpol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_bn.txt")
stargazer(rq_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_qp.txt")
r_p_inter=glm.nb(denuncias~n_pat_int + nreu_codisec + juntas + redes + per_juntas + per_redes, data = tesis)
summary(r_p_inter)
stargazer(r_p_inter, type = "text", title = "Articulacion interinstitucional",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Patrullaje integrado", "Número de reuniones del Codisec","Numero de juntas vecinales", "Número de redes de cooperantes","Número de personas en juntas vecinales","Número de personas en redes","Internet"),
out = "resultados_regresion_art_bn.txt")
stargazer(r_p_inter, type = "text", title = "Articulacion interinstitucional",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Patrullaje integrado", "Número de reuniones del Codisec","Numero de juntas vecinales", "Número de redes de cooperantes","Número de personas en juntas vecinales","Número de personas en redes"),
out = "resultados_regresion_art_bn.txt")
names(tesis)
r_conf=glm.nb(denuncias~conf_pnp + conf_muni + conf_pj + conf_mpfn, data = tesis)
summary(r_conf)
stargazer(r_conf, type = "text", title = "Confianza Institucional",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Confianza PNP", "Confianza Municipalidad","Confianza Poder Judicial", "Confianza Fiscalía"),
out = "resultados_reg_conf.txt")
knitr::opts_chunk$set(echo = TRUE)
library(AER)
library(ggplot2)
library(magrittr)
library(MASS)
library(stargazer)
library(kableExtra)
library(rio)
library(knitr)
library(modelsummary)
tesis=import("https://github.com/krlos20203563/Extortion_Peru/raw/refs/heads/main/datafinal.csv")
reg_pol=glm(denuncias ~ num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = poisson(link = "log"))
stargazer(reg_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_poisson.txt")
overdispersion <- AER::dispersiontest(reg_pol, alternative = 'greater')$p.value < 0.05
underdispersion <- AER::dispersiontest(reg_pol, alternative = 'less')$p.value < 0.05
# Crear tabla con los resultados
testResult <- data.frame(
Tipo = c("Sobredispersión", "Subdispersión"),
Resultado = c(overdispersion, underdispersion)
)
# Imprimir tabla como texto simple, adecuado para Word
print(testResult)
reg_bnpol=glm.nb(denuncias~num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis)
summary(reg_bnpol)
stargazer(reg_bnpol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_bn.txt")
rq_pol=glm(denuncias~num_comisarias + personal + n_patru + area_com + old_com + com_internet, data = tesis, family = quasipoisson(link = "log"))
summary(rq_pol)
stargazer(rq_pol, type = "text", title = "Capacidades estatales de la PNP",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Número de Comisarías", "Personal","Patrullaje por día","Area","Años de las comisarías","Internet"),
out = "resultados_regresion_qp.txt")
r_p_inter=glm.nb(denuncias~n_pat_int + nreu_codisec + juntas + redes + per_juntas + per_redes, data = tesis)
summary(r_p_inter)
stargazer(r_p_inter, type = "text", title = "Articulacion interinstitucional",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Patrullaje integrado", "Número de reuniones del Codisec","Numero de juntas vecinales", "Número de redes de cooperantes","Número de personas en juntas vecinales","Número de personas en redes"),
out = "resultados_regresion_art_bn.txt")
names(tesis)
r_conf=glm.nb(denuncias~conf_pnp + conf_muni + conf_pj + conf_mpfn, data = tesis)
summary(r_conf)
stargazer(r_conf, type = "text", title = "Confianza Institucional",
dep.var.labels = "Número de Denuncias",
covariate.labels = c("Confianza PNP", "Confianza Municipalidad","Confianza Poder Judicial", "Confianza Fiscalía"),
out = "resultados_reg_conf.txt")
View(tesis)
setwd("~/Tesis_de_Licenciatura/Extortion_Peru")
